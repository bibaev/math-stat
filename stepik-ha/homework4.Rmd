---
title: "stepik-4"
output: html_document
---
Seminar 4. Step 2

```{r}
set.seed = 20

sample = rnorm(30, mean=-1, sd = 2)

fun_t = function(sample, h0) {
  n = length(sample)
  sd = sqrt(var(sample) * (n - 1) / n)
  mean = mean(sample)
  return(sqrt(n) * (mean - h0) / sd)
}

print(round(fun_t(sample, 1), 3))
```
Проверяется гипотеза о равенстве мат. ожидания нормально распределенной генеральной совокупности 0 при альтернативе "мат.ожидание больше 0". Дисперсия известна и равна 4. В качестве статистики критерия было выбрано выборочное среднее. Найдите p-значение (p-value), если  значение выборочного среднего, посчитанного по выборке объемом 25, составило 0.85.

Подсказка: если генеральная совокупность имеет нормальное распределение, то и выборочное среднее имеет нормальный закон распределения, как линейная комбинация нормально распределенных случайных величин. Для того, чтобы найти параметры распределения, вспомните первый модуль.

```{r}
sd = sqrt(4) / sqrt(25)
1 - pnorm(0.85, 0, sd)
```

Существует предположение о том, что предвкушение дня рождения продлевает жизнь. Для того, чтобы проверить данное предположение статистически воспользуемся данными некрологов, опубликованных в Солт-Лейк-Сити в 1975 года. Согласно этим данным только 60 из 747 человек скончались в течение трехмесячного периода, предшествующего их дням рождения. Подтверждают ли эти данные предположение?

Уровень значимости возьмите 0.02

Формат ответа: через запятую с пробелом 

* значение статистики критерия (число успехов, с точностью 0 знаков после запятой),
* левая граница критической области, 
* правая граница критической области, 
* статистическое решение (1-теория о продлении жизни верна, 0 - наблюдения не подтверждают данную теорию)
Числовая граница критической области указывается с точностью 2 знака после запятой. Если же граница +/- бесконечность, то +infty или -infty (знак пишем).

```{r}
alpha = 0.02
k = 60
n = 747
z = k
p0 = 0.25
u = qnorm(1 - alpha)
left = n * p0 + sqrt(n * p0 * (1 - p0)) * u
print(paste(round(z, 2), round(left), "+infty", "H1", sep = ", "))

binom.test(x = 60, n = 747, p = p0, alternative = "less", conf.level = alpha)
qbinom(p = 0.08032129 , size = n, prob = p0)
```

Правда ли, что средний вес мозга взрослого мужчины равен 1400 гр?

Проверьте данную гипотезу по предложенной выборке:

```{r}
sample = c(1380, 1344, 1356, 1291, 1308, 1271, 1371, 1430, 1381, 1457, 1492, 1240, 1256, 1466, 1214, 1448,
1510, 1395, 1507, 1264, 1293, 1251, 1380, 1386, 1411, 1434, 1302, 1529, 1352, 1494, 1348, 1464,
1286, 1345, 1491, 1259, 1541, 1214, 1310, 1286)
n = length(sample)
```

Будем предполагать, что выборка получена из нормального распределения с ско 95гр.
Уровень значимости 0.03.
Проверьте гипотезу H0:a=1400 против H1:a=1300 

```{r}
h0 = 1400
h1 = 1300
sd = 95
alpha = 0.03
```


Формат ответа через запятую с пробелом

* выборочное значение статистики критерия (центрированная, нормированная, с точностью 2 знака после запятой)
* левая граница критической области (с точностью 2 знака после запятой. Если же граница +/- бесконечность, то +infty или -infty (знак пишем))
* правая граница критической области (с точностью 2 знака после запятой. Если же граница +/- бесконечность, то +infty или -infty (знак пишем))
* p-значение (с точностью 2 знака после запятой)
* статистическое решение (H0 или H1). Если приняли нулевую гипотезу пишем H0, в противном случае H1.

Решение:
```{r}
mean = mean(sample)
z = sqrt(n) * (mean - h0) / sd
right = qnorm(alpha)
p_value = pnorm(z)
print(paste(round(z, 2), '-infty', round(right, 2), round(p_value, 2), "H1", sep = ", "))
```

Проверьте гипотезу H0:a=1400 против H1:a!=1400 
* выборочное значение статистики критерия (центрированная, нормированная, с точностью 2 знака после запятой)
* левая граница области принятия гипотезы (с точностью 2 знака после запятой. Если же граница +/- бесконечность, то +infty или -infty (знак пишем))
* правая граница области принятия гипотезы(с точностью 2 знака после запятой. Если же граница +/- бесконечность, то +infty или -infty (знак пишем))
* p-значение (с точностью 2 знака после запятой)
* статистическое решение (H0 или H1). Если приняли нулевую гипотезу пишем H0, в противном случае H1.

```{r}
h0 = 1400
z = sqrt(n) * (mean - h0) / sd
left = qnorm(alpha / 2)
right = qnorm(1 - alpha / 2)
p_value = 2 * min(pnorm(z), 1 - pnorm(z))
print(paste(round(z, 2), round(left, 2), round(right, 2), round(p_value, 2), "H0", sep = ", "))
```

Будем предполагать, что выборка получена из нормального распределения с неизвестной дисперсией .
Уровень значимости 0.03.
Проверьте гипотезу H0:a=1400 против H1:a≠1400 

```{r}
s = sqrt(var(sample))
z = sqrt(n) * (mean - h0) / s
left = qt(alpha / 2, df = n - 1)
right = qt(1 - alpha / 2, df = n - 1)
p_value = 2 * min(pt(z, df = n - 1) , 1 - pt(z, df = n - 1))
print(paste(round(z, 2), round(left, 2), round(right, 2), round(p_value, 2), "H0", sep = ", "))
```

Вы хотите найти такой вид инвестирования, который бы давал твердый доход, по крайней мере 13.2%. Для этого вам необходимо проверить, является ли выборочное среднее доказательством того, что реальный доход больше проверяемого значения доходности. Вы подумываете инвестировать в облигации A. По данным 40 наблюдений среднемесячная доходность, приведенная к годовому базису, по выбранным облигациям составила 14.4%, а выборочное среднеквадратическое отклонение - 2.915%. Предположим, что доходность подчиняется нормальному закону. Уровень значимости 0.01.

Найдите выборочное значение статистики Z и примите статистическое решение

Формат ответа: через запятую с пробелом 
* выборочное значение статистики с точностью 2 знака после запятой и 
* выбранная гипотеза (H0 или H1). Если вы приняли нулевую гипотез, то H0, иначе  H1 
```{r}
n = 40
a0 = 13.2
mean = 14.4
sd = sqrt((2.915^2) * (n - 1) / n)
alpha = 0.01
z = sqrt(n) * (mean - a0) / sd
t_0 = qt(p = 1 - alpha, df = n - 1)
print(paste(t_0))
print(paste(round(z, 3), "H1", sep = ", "))
```

Пусть ξ∼N(a,σ), a неизвестно, σ=2 

Проверяется гипотеза H0:a=5 при альтернативе H1=5.5.

Какого объема следует взять выборку, чтобы вероятность ошибки первого рода не превосходила  0.05, а вероятность ошибки второго рода - 0.1? Найдите наименьшее значение

Ответ: ближайшее наименьшее целое,  большее полученного значения

```{r}
evaluate = function(diff, sd, alpha, beta) {
  u_alpha = qnorm(1 - alpha)
  u_beta = qnorm(beta)
  return(sd^2 * (u_alpha - u_beta)^2) / (diff^2)
}

a0 = 5
a1 = 5.5
alpha = 0.05
beta = 0.1
print(floor(evaluate(a0 - a1, 2, alpha = alpha, beta = beta)))
```



